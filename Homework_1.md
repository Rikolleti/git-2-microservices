# Задача 1: API Gateway

Для микросервисной архитектуры нужен шлюз, который будет принимать все входящие запросы, направлять их в нужный сервис,
проверять авторизацию и шифровать соединение. 
Я рассмотрел три варианта: Kong Gateway, NGINX, и AWS API Gateway.

| Критерий                          | **Kong Gateway**                                                                                | **NGINX**                                                                 | **AWS API Gateway**                                                    |
| :-------------------------------- | :---------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------ | :--------------------------------------------------------------------- |
| **Маршрутизация запросов**        | Поддерживает REST, gRPC и GraphQL. Гибкая настройка маршрутов через файлы или панель.           | Хорошо работает с REST. Настройка маршрутов вручную в конфиге.            | Поддерживает REST и HTTP API. gRPC — ограниченно.                      |
| **Аутентификация и безопасность** | Есть готовые плагины для OAuth2, JWT, API Keys. Можно быстро включить нужную схему авторизации. | Можно сделать Basic Auth, остальное нужно добавлять вручную через модули. | Есть встроенная поддержка Cognito, API Keys и Lambda Authorizers.      |
| **HTTPS / TLS терминация**        | Поддерживает HTTPS, можно подключить cert-manager для автоматического обновления сертификатов.  | Умеет работать с HTTPS, но требует ручной настройки сертификатов.         | HTTPS включён по умолчанию, сертификаты через AWS Certificate Manager. |
| **Развёртывание и управление**    | Можно установить в Kubernetes или Docker. Есть бесплатная версия (open-source).                 | Самый простой вариант, но всё настраивается вручную.                      | Полностью управляемый сервис от AWS, ничего не нужно устанавливать.    |
| **Стоимость**                     | Бесплатно (open-source).                                                                        | Бесплатно (open-source).                                                  | Платно — оплата за запросы и трафик.                                   |

### Вывод:
Я бы выбрал Kong Gateway, потому что он:
1. поддерживает нужные протоколы (REST, gRPC);
2. умеет проверять токены и API ключи;
3. легко работает с HTTPS;
4. бесплатный.

# Задача 2: Брокер сообщений

Я сравнил три популярных решения: RabbitMQ, Apache Kafka и Redis.

| Критерий                         | **RabbitMQ**                                   | **Apache Kafka**                                         | **Redis**                                                              |
| :------------------------------- | :--------------------------------------------- | :------------------------------------------------------- | :--------------------------------------------------------------------- |
| **Кластеризация**                | Есть, но требует ручной настройки.             | Есть, поддерживает масштабирование и отказоустойчивость. | Есть (Redis Cluster или Sentinel), но проще, чем у Kafka.              |
| **Хранение сообщений на диске**  | Да, можно сохранять до подтверждения доставки. | Да, хранит все сообщения в логах.                        | По умолчанию в памяти, но можно включить сохранение на диск (RDB/AOF). |
| **Скорость работы**              | Высокая, подходит для большинства задач.       | Очень высокая, рассчитана на большие потоки данных.      | Очень высокая, особенно при работе из памяти.                          |
| **Поддержка форматов сообщений** | Любые (JSON, текст, двоичные данные).          | Любые (чаще Avro, JSON, Protobuf).                       | Любые (в двоичном или строковом виде).                                 |
| **Разделение прав доступа**      | Есть (пользователи, виртуальные хосты).        | Есть ACL на уровне топиков.                              | Есть базовая авторизация и ACL.                                        |
| **Простота эксплуатации**        | Прост в установке и настройке.                 | Сложнее, требует больше ресурсов.                        | Очень простой, можно поднять за минуты.                                |

###
Вывод
Для нашей системы я бы выбрал RabbitMQ, потому что:
1. он поддерживает кластеризацию и хранение сообщений на диске;
2. подходит для обмена сообщениями между микросервисами;
3. Прост в установке и эксплуатации.

Redis подойдёт, если нужна очень высокая скорость и небольшие объёмы сообщений, где можно работать в памяти.
Kafka больше подходит для крупных систем, где нужно обрабатывать большие потоки данных, но её сложнее администрировать.
